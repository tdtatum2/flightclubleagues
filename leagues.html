<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://kit.fontawesome.com/663ad27e23.js" crossorigin="anonymous"></script>
</head>
<body>
    <!-- Add Bootstrap CSS (Required) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="styles.css">

<div class="container mt-4">
    <h2>Current Leagues <span class="small-subtitle">Season 1</span></h2>

    <div class="accordion" id="leaguesAccordion">
        <!-- League Accordion Item -->
        <div class="accordion-item" id="s1-a-mens">
            <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
                    <img src="logo.png" alt="Flight Logo" style="height: 50px; margin-right: 25px;"> Adult Men's League <span class="badge text-white text-bg-warning text-align-center mx-4 pulsing-background">In Progress</span>
                </button>
            </h2>
            <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#leaguesAccordion">
                <div class="accordion-body">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#matches" type="button">Matches</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#news" type="button">News</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#standings" type="button">Standings</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#roster" type="button">Roster</button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#bracket" type="button">Bracket</button>
                        </li>
                    </ul>
                    <div class="tab-content mt-3">
                        <div class="tab-pane fade show active" id="matches">
                            <div class="tab-content mt-3">
                                <div class="tab-pane fade show active" id="week1">
                                    <h5>Week 1 Matches</h5>
                                    <p>Match data for Week 1 goes here...</p>
                                </div>
                                <div class="tab-pane fade" id="week2">
                                    <h5>Week 2 Matches</h5>
                                    <p>Match data for Week 2 goes here...</p>
                                </div>
                                <div class="tab-pane fade" id="week3">
                                    <h5>Week 3 Matches</h5>
                                    <p>Match data for Week 3 goes here...</p>
                                </div>
                                <div class="tab-pane fade" id="week4">
                                    <h5>Week 4 Matches</h5>
                                    <p>Match data for Week 4 goes here...</p>
                                </div>
                            </div>
                        
                            <!-- Week Navigation Pills (Now at the Bottom) -->
                            <ul class="nav nav-pills mt-4 week-nav">
                                <li class="nav-item">
                                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#week1" type="button">Week 1</button>
                                </li>
                                <li class="nav-item">
                                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#week2" type="button">Week 2</button>
                                </li>
                                <li class="nav-item">
                                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#week3" type="button">Week 3</button>
                                </li>
                                <li class="nav-item">
                                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#week4" type="button">Week 4</button>
                                </li>
                            </ul>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
                            <symbol id="exclamation-triangle-fill" viewBox="0 0 16 16">
                              <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                            </symbol>
                        </svg>
                        <div class="tab-pane fade" id="news">
                            <div class="alert alert-danger d-flex align-items-center" role="alert">
                                <svg class="bi flex-shrink-0 me-2" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill"/></svg>
                                <div>
                                <h4 class="alert-heading">Court Resurfacing March 21st</h4>
                                <p>
                                    In our ongoing effort to provide the best possible facility, we have made the difficult decision to repaint our courts.
                                    To ensure the paint has the proper curing time, league will <strong>not be held on Monday, March 24th.</strong>
                                </p>
                                <hr>
                                <p>We apologize for the inconvenience. Our facility will be closed starting <strong>March 21st</strong>. We will reopen on <strong>Monday, March 31st.</strong></p>
                            </div>
                            </div>
                            <div class="alert alert-danger d-flex align-items-center" role="alert">
                                <svg class="bi flex-shrink-0 me-2" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill"/></svg>
                                <div>
                                    <h4 class="alert-heading">Court Resurfacing March 31st</h4>
                                    <p>
                                        Unfortunately, the timeline for the resurfacing has changed. To allow time for the paint crew to resupply and finish resurfacing,
                                        as well as to ensure the paint has the proper curing time, league will <strong>not be held on Monday, March 31st.</strong>
                                    </p>
                                    <hr>
                                    <p>
                                        We apologize for the inconvenience. Our facility will reopen on <strong>Wednesday, April 2nd</strong>. The league schedule will be pushed back
                                        two weeks to accomodate.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="standings">
                            <div class="d-flex flex-column m-3 align-items-center">
                                <div class="d-flex flex-row p-5">
                                    <div class="mx-3 p-5 mt-4 silver-standings text-center">
                                        <span id="silver-team"></span>
                                        <br>
                                        <span id="silver-points"></span>
                                    </div>
                                    <div class="mx-3 p-5 mb-4 gold-standings">
                                        <span id="gold-team"></span>
                                        <br>
                                        <span id="gold-points"></span>
                                    </div>
                                    <div class="mx-3 p-5 mt-4 bronze-standings">
                                        <span id="bronze-team"></span>
                                        <br>
                                        <span id="bronze-points"></span>
                                    </div>
                                </div>
                                <div class="p-2">4th Place Team D</div>
                                <div class="p-2">5th Place Team E</div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="roster"></div>
                        <div class="tab-pane fade" id="bracket">HELLO</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Bootstrap JS (Required for Accordions & Tabs to Work) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function sendHeight() {
        parent.postMessage({ type: 'resize', height: document.body.scrollHeight }, '*');
    }
    
    window.addEventListener('load', sendHeight);
    window.addEventListener('resize', sendHeight);
</script>
<script>
    const sheetID = "1QChu5pscRkO5we0l32ntSgXHdZBuSOgJxF1cqHxqCMM";
    const apiKey = "AIzaSyCEYYipfQJG5D4FXitCxdeNYQxqplNwAGI";
    const rosterRange = "Schedule!A3:C14";
    const standingsRange = "Standings!N3:P14";

    const goldTeam = '<i class="fa-solid fa-ranking-star" style="color: #ffcd00;"></i>';
    const silverTeam = '<i class="fa-solid fa-ranking-star" style="color: #c0c0c0;"></i>';
    const bronzeTeam = '<i class="fa-solid fa-ranking-star" style="color: #c96d22;"></i>';
    
    const rosterURL = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${rosterRange}?key=${apiKey}`;
    const standingsURL = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${standingsRange}?key=${apiKey}`;

    // Data.Values becomes individual arrays for each team. 0 is partner 1. 1 is partner 2. 2 is team name.
    fetch(rosterURL)
        .then(response => response.json())
        .then(data => {
            let table = "<table class='table table-dark table-striped' border='1'> <thead> <tr class='table-header-gold'><th scope='col'>Team Name</th><th scope='col'>Partner 1</th><th scope='col'>Partner 2</th></tr></thead><tbody>";
            let counter = 1;
                data.values.forEach(team => {
                    table += `<tr> <th scope='row'>${team[2]}</th> <td>${team[0]}</td> <td>${team[1]}</td> </tr>`;
                });
                table += "</tbody></table>";
                document.getElementById("roster").innerHTML = table;
                return(fetch(standingsURL))
        })
        // STANDINGS SECTION
        .then(response => response.json())
        .then(data => {
            data.values.forEach(rankedTeam => {
                if (rankedTeam[0] === '1') {
                    document.getElementById("gold-team").innerHTML = `${goldTeam} ${rankedTeam[1]}`;
                    document.getElementById("gold-points").innerHTML = `${rankedTeam[2]} Points`;
                } else if (rankedTeam[0] === '2') {
                    document.getElementById("silver-team").innerHTML = `${silverTeam} ${rankedTeam[1]}`;
                    document.getElementById("silver-points").innerHTML = `${rankedTeam[2]} Points`;
                } else if (rankedTeam[0] === '3') {
                    document.getElementById("bronze-team").innerHTML = `${bronzeTeam} ${rankedTeam[1]}`;
                    document.getElementById("bronze-points").innerHTML = `${rankedTeam[2]} Points`;
                } else {    
                    content += `<div class='p-2'>${rankedTeam[0]} ${rankedTeam[1]}</div>`;
                } 
            })
            content += "</div>";
            document.getElementById("standings").innerHTML = content;
        });

    
</script>
    
    
</body>
</html>